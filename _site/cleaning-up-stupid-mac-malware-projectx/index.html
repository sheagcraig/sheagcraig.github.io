<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Cleaning up stupid Mac malware: "ProjectX" &#8211; Taco Destroyer</title>
<meta name="description" content="
"Becoming is certainly not imitating, or identifying with
something; neither is it regressing-progressing; neither is it corresponding,
establishing corresponding relations; neither is it producing, producing a
filiation or producing through filiation. Becoming is a verb with a consistency
all its own; it does not reduce to, or lead back to, appearing,"
– Gilles Deluze and Félix Guattari, A Thousand Plateaus

">
<meta name="keywords" content="">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Cleaning up stupid Mac malware: "ProjectX"">
<meta name="twitter:description" content="
"Becoming is certainly not imitating, or identifying with
something; neither is it regressing-progressing; neither is it corresponding,
establishing corresponding relations; neither is it producing, producing a
filiation or producing through filiation. Becoming is a verb with a consistency
all its own; it does not reduce to, or lead back to, appearing,"
– Gilles Deluze and Félix Guattari, A Thousand Plateaus

">
<meta name="twitter:site" content="@shea_craig">


<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Cleaning up stupid Mac malware: "ProjectX"">
<meta property="og:description" content="
"Becoming is certainly not imitating, or identifying with
something; neither is it regressing-progressing; neither is it corresponding,
establishing corresponding relations; neither is it producing, producing a
filiation or producing through filiation. Becoming is a verb with a consistency
all its own; it does not reduce to, or lead back to, appearing,"
– Gilles Deluze and Félix Guattari, A Thousand Plateaus

">
<meta property="og:url" content="/cleaning-up-stupid-mac-malware-projectx/">
<meta property="og:site_name" content="Taco Destroyer">

<meta property="og:image" content="/images/default-thumb.png">






<link rel="canonical" href="/cleaning-up-stupid-mac-malware-projectx/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Taco Destroyer Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Taco Destroyer</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Sample Posts</a></li>
				
				    
				        
				    
				    <li><a href="/theme-setup/" >Theme Setup</a></li>
				
				    
				        
				        
				    <li><a href="http://mademistakes.com" target="_blank">Made Mistakes</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/" class="bio-photo" alt=" bio photo">


  <h3 itemprop="name"></h3>
  <p></p>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/cleaning-up-stupid-mac-malware-projectx/" rel="bookmark" title="Cleaning up stupid Mac malware: "ProjectX"">Cleaning up stupid Mac malware: "ProjectX"</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/V.jpg" alt="V" /></p>
<blockquote>"Becoming is certainly not imitating, or identifying with
something; neither is it regressing-progressing; neither is it corresponding,
establishing corresponding relations; neither is it producing, producing a
filiation or producing through filiation. Becoming is a verb with a consistency
all its own; it does not reduce to, or lead back to, appearing,"</blockquote>
<p>– Gilles Deluze and Félix Guattari, A Thousand Plateaus</p>

<p>I thought it would be useful to describe the research and removal process of a
recent support case involving a faculty member who had inadvertently gotten
some malware. What I didn’t realize was the strange story of becoming and
identity hidden in this seemingly simple procedure. I didn’t expect to be
thrown into confusion at the mysterious person, identified in many ways
throughout the course of my investigation, but most interestingly so, as simply
“V”.</p>

<p>All of our laptop users, both faculty and student, have administrative rights
on their laptops. This is an important decision to us, and we feel strongly
about continuing to grant those privileges. However, sometimes users can get
into trouble, particularly when it comes to misleading software offering to be
“helpful”, as we will see. It is this administrative privilege which can lead
to serious issues. Fortunately, the malware involved in this particular
instance is pretty stupid. I know if I was a dirtbag malware author and I was
granted admin privileges as part of a software installation process, I can
think of a lot better things to do than to just hijack Webkit’s default search
engine and home page…</p>

<p>When I received the laptop, it had a ton of junky popup-laden websites with
audio informing me that this laptop was infected with a virus, and I should
call a phone number right away. After working with the laptop a little bit, it
became apparent that the symptoms were  limited to Chrome and Safari, and were:</p>

<ol>
  <li>An inability to set and retain a HomePage after browser restarts.</li>
  <li>Search omnibar set to Google in preferences, yet getting sent to Yahoo.</li>
  <li>eCommerce sites like Amazon have an obtrusive overlay of other products from
an unrelated site.</li>
  <li>All cookies are accepted. If preference is changed, it gets reset to allow
all cookies upon browser restart.</li>
</ol>

<p>I have cleaned several of these things in the last few weeks, so clearly I can
expect to see more in the future. This one in particular was masquerading as an
FLV video player. I imagine the user found a video somewhere and couldn’t
figure out how to play it. (I haven’t been able to figure out where or what the
user searched for). “FLVPlayer1” was there to help.</p>

<p>The user downloaded the disk image, mounted it, and ran the “installer” app
contained within. Soon after, the user found that Safari and Chrome both kept
setting the home page, despite reset/quit/restart cycles, to
“www.only-search.com”. Also, searches from the omnibar were redirected to
“only-search”, despite the preferences clearly stating that Google was the
default search engine.</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-10.26.29-AM-300x249.png" alt="Screen Shot 2015-01-21 at 10.26.29 AM" /></p>

<p>Astute users would probably notice right away that this doesn’t look like a
standard installer package or drag-n-drop application wrapped in a dmg. Because
it isn’t. Also, notice the strange disk image name “SmartInstaller”… The disk
image file is named FlvPlayer1.dmg, but is mounted as SmartInstaller. My guess
on this is that “SmartInstaller”, and probably a lot of the later code, is
written by some individual who then sells his product to would-be ransomers,
who can customize the product to their needs (point it to their particular
ransom website, make it look like something useful in particular—in this case a
video player).</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-10.26.47-AM-300x164.png" alt="Screen Shot 2015-01-21 at 10.26.47 AM" /></p>

<p>The first thing it does is ask for an admin password, which is the <em>last</em> thing
that a legit installer does.</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-10.27.03-AM-300x216.png" alt="Screen Shot 2015-01-21 at 10.27.03 AM" /></p>

<p>Here we can see that the installer program clearly does not look like an
installer package. Why, malware author, not use the package format to make your
installer look more legit? I’m not sure. I don’t see anything in the installed
payload that wouldn’t work through a standard package. Again, this points to a
customizable product; specifically, it’s probably set up so that someone with
no knowledge of OS-specific deployment technologies can get up and running
quickly. I’m sure there’s a Windows version of “SmartInstaller”/ProjectX as
well.</p>

<p>Anyway, tellingly, the “I agree” checkbox for the “License Agreement” and
“Privacy Policy” doesn’t actually allow you to deselect it. If you continue,
you are agreeing. If you follow the links in the app I came across, they lead
to website with an unfamilar name, “deal-top.com”. We’ve gone from FlvPlayer1
to SmartInstaller to deal-top. Here are the links: <a href="http://www.deal-top.com/deal-top/terms-of-use">Terms of
Use</a> and <a href="http://www.deal-top.com/deal-top/privacy-policy">Privacy
Policy</a>, which seem like
pretty boilerplate legalese letting those interested enough in reading them
that Deal Top can basically do anything they want.</p>

<p>Deal Top is described as a browser plugin that offers you alternate shopping
opportunities (from a FLVPlayer?) and mentions specifically that you’re welcome
to uninstall it from the Internet Explorer, Chrome, or Firefox browser (my user
uses Safari…). If you browse onto the other pages on the website, it’s pretty
sparse.</p>

<p>There’s a download link which results in a disk image named “MPlayerX.dmg”, not
“FlvPlayer1.dmg”. Once mounted, they look strangely similar, although not
identical:
<img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-2.20.51-PM-300x124.png" alt="Screen Shot 2015-01-21 at 2.20.51 PM" /></p>

<p>I took a look at the binary contained within, and sure enough, they’re
identical. So “Deal Top”’s purported browser plugin is actually named
“MPlayerX.dmg”? That sounds more like a… media player? Right? And it is
identical to the “FlvPlayer1” which brought us here in the first place.</p>

<p>There is an amusing link at the bottom,
<a href="http://www.smart-installer.com/smart-installer/remove">“Uninstall”</a>, which
leads to a new site: <a href="http://www.smart-installer.com">www.smart-installer.com</a>.
The “uninstall” information is, actually, basically what I’m going to tell you
to do!</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-12.18.45-PM-300x77.png" alt="Screen Shot 2015-01-21 at 12.18.45 PM" /></p>

<p>This “smart-installer.com” site must be the destination for a lot of
“Uninstall” links, since you’ll notice that the identifier for the LaunchAgents
and LaunchDaemons only read “PackageToRemove”… Probably because there are
hundred if not thousands of “Deal Top”-like sites and installers pointing to
it.</p>

<p>Since the Terms of Use mention Internet Explorer, I assumed that there would be
a separate set of instructions for uninstalling on Windows. There aren’t. Just
to be sure, I used curl to download the uninstall page with a different user
agent, but got the same thing. I did see that smart-installer.com is being
served by nginx, so the mysterious author must be somewhat current.</p>

<p>By the way, <a href="http://www.smart-installer.com">www.smart-installer.com</a> src is
just an html tag with an empty head and an empty body. Curious.</p>

<p>I did a whois lookup on the websites mentioned above, without much useful
information. Most of them are registered by www.enom.com, which is in term
registered by GoDaddy. eNom is apparently based in Kirkland, WA, and you can
read about them from the Better Business Bureau
<a href="http://www.bbb.org/western-washington/business-reviews/internet-web-hosting/enom-incorporated-in-kirkland-wa-64002064">here</a>.
According to their Twitter profile, they are a wholesaler of domain names.
“deal-top.com” is registered by namecheap.com, and is protected by their
“whoisguard” product, which makes getting any information about who actually
owns these websites difficult to ascertain.</p>

<p>Looking at the actual compiled code for the installer, I found a certificate
chain that includes this mysterious entry:
<img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-12.38.24-PM.png" alt="Screen Shot 2015-01-21 at 12.38.24 PM" /></p>

<p>Who is this mysterious “Moshe Cohen”? Googling different things with “Moshe
Cohen flv player” (should I use only-search.com to look him up?) gives a top
hit of this blog post about how to use Chrome to download videos from Facebook.
But the article itself is not related to Moshe, rather, this comment:</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-12.39.56-PM.png" alt="Screen Shot 2015-01-21 at 12.39.56 PM" /></p>

<p>I’m not confident that it’s the same Moshe Cohen. Who knows.</p>

<p>Running the installer app through pkgutil’s –check-signature seems to check
out:
<img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-3.29.25-PM.png" alt="Screen Shot 2015-01-21 at 3.29.25 PM" /></p>

<p>I’d be interested to see if there’s some way to see get information on a valid,
registered Apple Developer.</p>

<p>Digging around in the installer some more, you can find this:</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-12.46.01-PM.png" alt="Screen Shot 2015-01-21 at 12.46.01 PM" /></p>

<p>Specifically, references to SIMBL, which is short for “Simple Bundle Loader”.
Check out the <a href="http://en.wikipedia.org/wiki/SIMBL">Wikipedia page.</a> It allows
you to load code into an application to manipulate it in ways that the original
developer did not provide. A nice way of referring to them would be “unofficial
plugins”, and a not so nice way would be “hacks”. I’m not sure that SIMBL stuff
even works any more… Still, there’s a lot of references to
<a href="https://polarssl.org">PolarSSL</a>, which is ominous.</p>

<p>Further digging, and lo! More mystery!</p>

<p>Buried deep in the agent, is a twisted koan of some kind: /Library/Application
Support/projectX/Agent/agent.app/Contents/Resources/en.lproj/Credits.rtf reads
(in its entirety):</p>

<blockquote>
**Engineering:**
    Some people
**Human Interface Design:**
    Some other people
**Testing:**
    Hopefully not nobody
**Documentation:**
    Whoever
**With special thanks to:**
    Mom
</blockquote>

<p>Now, this is something! It goes from sarcasm to worry to nihilism to familial
gratitude in a rollercoaster haiku of a few mere lines. Somewhere out there, a
deeply questioning V wants his mother to know, despite their estrangement, that
he still thinks fondly of her.</p>

<p>Who is testing? Hopefully not nobody! Who has documented this undertaking?
Whoever? Perhaps nobody. Perhaps someone. It is unimportant. Documentation is
in the past, a dead thing. V is only interested in moving forward,
(Engineering: some <em>people</em>, living, breathing, thinking beings with lives and
families)</p>

<p>Anyway, back to the installer.</p>

<p>Amusingly, it gives you the sham option of a “Quick (Recommended)” install, and
an “Advanced” install. (Sorry, forgot to make a screenshot).</p>

<p>Here are the files installed by our installer:
<img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-10.47.51-AM.png" alt="Screen Shot 2015-01-21 at 10.47.51 AM" /></p>

<p>Just for down-and-dirty research, I used JAMF’s Composer to track filesystem
changes and generate the list above. I’ve removed the cruft from the
application saved-state caching system, etc, and just left the files installed
by “Smart Installer”.</p>

<p>So, we’re looking at a system framework, and an executable hidden in
Application Support, that is run and updated through a few LaunchAgents and
LaunchDaemons.</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-11.08.48-AM-300x146.png" alt="Screen Shot 2015-01-21 at 11.08.48 AM" /></p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-11.08.59-AM-300x168.png" alt="Screen Shot 2015-01-21 at 11.08.59 AM" /></p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-11.09.18-AM-300x163.png" alt="Screen Shot 2015-01-21 at 11.09.18 AM" /></p>

<p>All of these LaunchD jobs load the “Agent” included in the Application Support
folder, with different commandline arguments. I did some quick tcpdumps of
“agent”, running with each of the commandline arguments, and didn’t find
anything.</p>

<p>Notice, also, that the name has changed again. No longer “Smart Installer”,
“FLVPlayer1”, or “Deal Top”. Now we’re looking at the sinisterly-named
“projectx” (as per the reversed identifier). Perhaps as some kind of
obfuscation, the identifier specified in each plist is different. For example,
com.projectx.agent.plist shows up in LaunchD as “com.v.agent”. Being a fan of
Pynchon, this new moniker, simply “V”, appeals to me.</p>

<p>The installer finishes pretty quickly, and, TADA! Nothing happens. In fact,
NOTHING happens. I’m surprised that it doesn’t postinstall script start those
LaunchDaemons. No, you have to reboot to get them active. Once you do, however,
your home page is changed:
<img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-10.59.19-AM-300x164.png" alt="Screen Shot 2015-01-21 at 10.59.19 AM" /></p>

<p>You can change it back to whatever you like, but upon restarting Safari, it is
restored to “www-only-search.com”. This is what the “agent” is doing in the
background-making sure that certain preferences are set how “they” (be they
Moshe Cohen, Deal Top, “V”, etc) want it.</p>

<p>Another change is that it sets the cookie policy to allow all cookies. This is
a key in com.apple.Safari.plist. The installer sets it in the root preference
domain, at /var/root/Library/Preferences/com.apple.Safari.plist. The “agent”
enforces the setting, however, only in the user domain.</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-21-at-10.58.09-AM-300x109.png" alt="Screen Shot 2015-01-21 at 10.58.09 AM" /></p>

<p>I dumped all cookies from my test machine and quit Safari, and then restarted
Safari. Very quickly, I could see a bunch of cookies being added to the cookie
store. There must be some traffic going on in the background. After two
restarts I had 36 cookies.</p>

<p>If you toggle the cookie setting to block “Always”, upon the next restart, the
user preference is restored to “Never”. This happens regardless of whether you
change or delete the preference with defaults delete/write, or toggle it in the
preferences dialog. (The keys are WebKitStorageBlockingPolicy and
“com.apple.Safari.ContentPageGroupIdentifier.WebKit2StorageBlockingPolicy”. 0
is “Never”, and 2 is “Always”)</p>

<p>It took me a little while to figure out what else was happening. While it’s
annoying to have all of your omnibar searches pumped through Yahoo, that’s not
that bad. Eventually I decided to trust in the Terms of Use and try to engage
in some e-commerce. Well, well!</p>

<p><img src="/images/2015-01-21-cleaning-up-stupid-mac-malware-projectx/Screen-Shot-2015-01-22-at-11.37.23-AM-300x170.png" alt="Screen Shot 2015-01-22 at 11.37.23 AM" /></p>

<p>That’s not the Amazon we all know. There is actually an overlay, just like Deal
Top promised. Perhaps “V” is actually an upstanding entrepreneur. I made a
packet capture with tcpdump while surfing around Amazon on an infected computer
and, despite my relatively weak Wireshark skills, quickly identified some
interesting traffic. A lot of extra traffic was going to some IP’s which
included “www.superfish.com” in their requests. Superfish seems to be a
legitimate visual search product, but if you search for “superfish malware”
there does indeed seem to be a shopping “virus” named superfish. I plugged the
IP address into whois and interestingly enough, a new name appeared. A “Grahame
Cohen” is listed for a range of several IPs. Is this a relative of Moshe’s? A
brother? I think it’s just another one of V’s shifting personalities, an
alter-ego amongst many.</p>

<p>Not to mention, there’s also a little handle on the overlays labeled
“Offers4U”, just to add to the list of monikers, shell businesses, and mystery.
In reality, all of this trouble seems to be an attempt to send as much web
traffic through bizrate.com as possible to generate ad pay-per-click revenues.
This is click fraud-check it out. It’s a huge industry. Unfortunately, I don’t
know how to trace the pay-per-clicks to figure out who gets the money; who
benefits from V’s deception?</p>

<p>After all of that, how do we clean this stuff up? It’s actually quite simple.
The quick and dirty approach is to just delete the files installed and reboot.
Just to be nerdy, I like to unload them first just to be safe. So here’s how
it’s done.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="c">#### Sudo in and unload/disable LaunchD jobs.</span>
    <span class="nv">$ </span>sudo su -
    <span class="nv">$ </span>launchctl unload -w /Library/LaunchDaemons/com.projectx.*
    launchctl: Error unloading: com.v.daemon

    <span class="nv">$ </span><span class="c">#### Interesting that the &quot;daemon&quot; wasn&#39;t actually loaded...</span>
    <span class="nv">$ </span>launchctl unload -w /Library/LaunchAgents/com.projectx.agent.plist
    <span class="nv">$ </span>launchctl list <span class="p">|</span> grep com<span class="se">\.</span>v<span class="se">\.</span>.

    <span class="nv">$ </span><span class="c">### (Nothing to report)</span>
    <span class="nv">$ </span><span class="c">### Remove files...</span>
    <span class="nv">$ </span>rm -rf /Library/Application<span class="se">\ </span>Support/projectX /Library/Launch*/com.projectx.*.plist /System/Library/Frameworks/v.framework
    <span class="nv">$ </span><span class="c">### Fix cookie preferences</span>
    <span class="nv">$ </span>defaults delete com.apple.Safari WebKitStorageBlockingPolicy
    <span class="nv">$ </span>defaults delete com.apple.Safari <span class="s2">&quot;com.apple.Safari.ContentPageGroupIdentifier.WebKit2StorageBlockingPolicy&quot;</span>
    <span class="nv">$ </span><span class="c">### (Alternately, defaults write to set them to 1 or 2)</span>
    <span class="nv">$ </span><span class="nb">exit</span>
    <span class="nv">$ </span><span class="c">#### Back to &quot;me&quot;.</span>
    <span class="nv">$ </span>defaults delete com.apple.Safari WebKitStorageBlockingPolicy
    <span class="nv">$ </span>defaults delete com.apple.Safari <span class="s2">&quot;com.apple.Safari.ContentPageGroupIdentifier.WebKit2StorageBlockingPolicy&quot;</span>
    <span class="nv">$ </span>defaults write com.apple.Safari HomePage <span class="s2">&quot;http://slashdot.org&quot;</span></code></pre></div>

<p>(This is a simulated bash session. Feel free to make a script to do this,
although the names will probably all be different the next time you come across
it)</p>

<p>A reboot probably wouldn’t hurt. After all of this, things should be back to
normal.</p>

<p>This procedure is probably pretty similar across a variety of these “products”;
just look for LaunchAgents/LaunchDaemons in the system domain and see what
files they reference. At some point I plan on writing a little script to
automate some of the research that goes on for this so that you can quickly and
easily remove these things.</p>

<p>I look forward to my next adware removal. I want to see if V is involved. Has
he or she advanced in skill? Are there any more clues as to his mental state?
How is his mother?</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/cleaning-up-stupid-mac-malware-projectx/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/cleaning-up-stupid-mac-malware-projectx/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/cleaning-up-stupid-mac-malware-projectx/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Cleaning up stupid Mac malware: "ProjectX"</strong> was published on <time datetime="2015-01-21T15:40:54-05:00">January 21, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/putting-the-hopper-to-work-broken-preferences-edition/" title="Putting the Hopper to Work: Broken Preferences Edition">Putting the Hopper to Work: Broken Preferences Edition</a></li>
    
      <li><a href="/now-i-get-it-updating-mac-firmware/" title="Now I get it... Updating Mac firmware">Now I get it... Updating Mac firmware</a></li>
    
      <li><a href="/how-i-roll/" title="How I Roll">How I Roll</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Shea Craig. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


  



</body>
</html>
